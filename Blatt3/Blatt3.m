%---1a---%
disp('Aufgabe 1a')
t = 1:1/128:4;

f_1 = f1(t);
f_2 = f2(t);

plot(t,f_1)
plot(t,f_2)

%---1b---%
%See Blatt3_1b
%---2a---%

probabilities = [0.00755884677751513681	0.01105318515665493297	0.01552914585389562714	0.02096215430501338377	0.02718644859950228935	0.03387640098714970286	0.04055741546189319733	0.04665213235521837843	0.05155857994653319296	0.05474678451379861925	0.05585274379367638072	0.05474680062863296940	0.05155880295637878421	0.04665452995170378158	0.04057749029178835355	0.03400730532177234166	0.02785123566449935189	0.02359143815148195519	0.02362791025837613087	0.03048111099822337004	0.04385499069231837677	0.05777709401642099699	0.06297750499206178847	0.05471222151487304766	0.03740432347806352078	0.02004839376889902891	0.00843254167469389231	0.00280179707400135780	0.00075045459849946796	0.00017177750696501301];
xValues = 0:29;
%probabilities = [0.00004087317234236197	0.00704409180400179394	0.01404754487086270777	0.02105124786275876922	0.02805521716774932590	0.00005947011484634679	0.00706402501810598107	0.01406890122208058997	0.02107411914862283227	0.02807970034502881072	0.00008566753350240527	0.00709204466191772610	0.01409885695585110925	0.02110613097184824795	0.02811389465188590065	0.00012217737898114097	0.00713101003389431641	0.01414042505286476212	0.02115045648631087683	0.02816114005841841488	0.00017251322753278638	0.00718461524726279621	0.01419748722819459963	0.02121117220010572080	0.02822571517455978334	0.00024116320775315450	0.00725756546347502495	0.01427497327603255372	0.02129344021298262533	0.02831302213750151729	0.00033377727021338858	0.00735576625028800157	0.01437905219560751400	0.02140370076179155717	0.02842978019985918785	0.00045736141229570512	0.00748651800728179812	0.01451732635083208354	0.02154986561657984563	0.02858421783293475774	0.00062046792733059184	0.00765870376727046504	0.01469901619786808406	0.02174149907557478750	0.02878624929777400965	0.00083336682791715920	0.00788295471586788307	0.01493511911311533295	0.02198996928251143412	0.02904761760218233725	0.00110817956326028082	0.00817177376107906898	0.01523852187947434429	0.02230854866782887216	0.02938198191050321905	0.00145895238829356370	0.00853959383156099422	0.01562404286468057300	0.02271243894146375873	0.02980492427121451465	0.00190164373508766136	0.00900274479242780173	0.01610837737677850235	0.02321869378126440534	0.03033384853306360602	0.00245399825670399999	0.00957930152593540891	0.01670991870394916122	0.02384601177173845060	0.03098774414441623401	0.00313528047533266691	0.01028878644786110511	0.01744842855475052101	0.02461437386497276936	0.03178678977802547011	0.00396584376568531930	0.01115170310124235094	0.01834453457628300371	0.02554450420512873473	0.03275177691707730020	0.00496651623663561069	0.01218888395197617882	0.01941903977189351222	0.02665714097158225697	0.03390334202760535088	0.00615779424246777486	0.01342064535925956066	0.02069203916688037866	0.02797211509640713930	0.03526100780921543281	0.00755884677751513681	0.01486575585800996112	0.02218185285943989103	0.02950724910481424231	0.03684204898919115676	0.00918634953390664344	0.01654023993820250052	0.02390380112924742434	0.03127710531158911107	0.03866021551711696568	0.01105318515665493297	0.01845605757434173759	0.02586886560599124527	0.03329163114265851749	0.04072436470066721133	0.01316706499938106384	0.02061971854802608710	0.02808229924289058529	0.03555476797624699220	0.04303707225835262994	0.01552914585389562714	0.02303090843425724016	0.03054226524696253472	0.03806310680368766326	0.04559330858818368212	0.01813273078546387460	0.02568121803358377756	0.03323859919932046448	0.04080468717903004564	0.04837927872592975661	0.02096215430501338377	0.02855307797676610863	0.03615179731079714669	0.04375804333045583771	0.05137153048943916222	0.02399195668133608184	0.03161900328298672088	0.03925233523246233667	0.04689160114239540151	0.05453643344930809777	0.02718644859950228920	0.03484124727198477649	0.04250041463880859727	0.05016352066311453334	0.05783012043505710421	0.03049975454569644236	0.03817194949883186184	0.04584621816064497119	0.05352206024691018154	0.06119896284741877430	0.03387640098714969072	0.04155383822360626803	0.04923072727962366927	0.05690651071083714138	0.06458062160688690102	0.03725248432532181278	0.04492151525705151517	0.05258712362208569769	0.06024871229419026849	0.06790567865298361143	0.04055741546189244143	0.04820331177028635798	0.05584275383801348733	0.06347512608046700958	0.07109981203222428977	0.04371619532721716641	0.05132366069331407328	0.05892159495912244614	0.06650938807075363952	0.07408643411623267781	0.04665213235518189629	0.05420588825136117309	0.06174711450560827473	0.06927523208669106850	0.07678967125755920175	0.04928987259446649188	0.05677528799642686027	0.06424538168246629915	0.07169963117414117081	0.07913752826080916134	0.05155857994516346993	0.05896230936657330184	0.06634825669981440750	0.07371598002682219583	0.08106505617915674104	0.05339508154893365555	0.06070567286604714578	0.06799646793959139592	0.07526712636147349982	0.08251733017030521605	0.05474678447376155787	0.06195521802770132243	0.06914238377045775970	0.07630805931082630051	0.08345204736840020380	0.05557417616503371813	0.06267429976634543528	0.06975229837231147959	0.07680807855613854201	0.08384157345075003546	0.05585274288236430890	0.06284157345079138834	0.06980807855622358920	0.07675229837244502567	0.08367429976653499714	0.05557417616528991334	0.06245204736873729633	0.06930805931126292919	0.07614238377101788320	0.08295521802841542406	0.05474678447466816504	0.06151733017145280278	0.06826712636292285733	0.07499646794141857566	0.08170567286834710353	0.05339508155182475369	0.06006505618278630103	0.06671598003137333489	0.07334825670551444414	0.07996230937370407586	0.05155857995407399629	0.05813752827193112551	0.06469963118800787950	0.07124538169973582783	0.07777528801791029139	0.04928987262116232035	0.05578967129069520259	0.06227523212777518130	0.06874711455649037012	0.07520588831430793486	0.04665213243296749082	0.05308643421224840225	0.05950938818914035550	0.06592159510493033355	0.07232366087269509846	0.04371619554765667291	0.05009981230281931318	0.05647512641226032206	0.06284275424439402497	0.06920331226746861611	0.04055741606948968432	0.04690567939469238576	0.05324871319860679419	0.05958712472367830385	0.06592151659731746983	0.03725248595416175258	0.04358062358423570006	0.04990651310859658204	0.05623073018394982032	0.06255384173761318161	0.03387640523410106425	0.04019896797449076918	0.04652206642962185430	0.05284622560806798486	0.05917195845970856333	0.03049976531561530225	0.03683013336485723685	0.04316353616871690086	0.04950043321270094059	0.05584126949662074033	0.02718647516291308871	0.03353646516326793120	0.03989163896353021227	0.04625238028674608798	0.05261905689413073845	0.02399202040364597229	0.03037160614579111272	0.03675813305613059093	0.04315190360400653037	0.04955320375681464769	0.02096230297915726344	0.02737945426612832565	0.03380489420993229520	0.04023884309899169239	0.04668150504865720103	0.01813306816259958259	0.02459370472393435583	0.03106357141510829888	0.03754280956556135464	0.04403154542616845517	0.01552989046946307837	0.02203794171464792718	0.02855578207640785282	0.03508348073655586333	0.04162109353756455728	0.01316866339706234283	0.01972622074240604016	0.02629378396447856290	0.03287135988990192281	0.03945894427090133380	0.01105652229210518275	0.01766406909361749916	0.02428155030975364530	0.03090892262288555126	0.03754613433189915647	0.00919312593482294568	0.01584983072524167348	0.02251617540216257772	0.02919208069305154715	0.03587746198980272631	0.00757222999744574619	0.01427629139542894102	0.02098954951134327992	0.02771190500696899291	0.03444325657653365654	0.00618350165706545237	0.01293253715070703800	0.01969026015882258999	0.02645656872768172615	0.03323136260543785509	0.00501454401003375581	0.01180601840756265089	0.01860569530048759564	0.02541348902497467233	0.03222931955642541407	0.00405311332210041999	0.01088480401950880054	0.01772433343899667935	0.02457165228870251128	0.03142672101975778194	0.00328951064929938455	0.01016000357852563008	0.01703819440267282109	0.02392409070941540220	0.03081771386180211504	0.00271909976143600605	0.00962829958719070836	0.01654538050433276614	0.02347042633849400454	0.03040353820851367109	0.00234483511175236982	0.00929445445507423207	0.01625255252430632365	0.02321930488462140099	0.03019490670395861140	0.00217957299130372539	0.00917353874140341964	0.01617705897729463007	0.02319040868189784095	0.03021388260986018591	0.00224779497084819099	0.00929247897558851198	0.01634828623614547795	0.02341558601221363388	0.03049476429559825945	0.00258622272556287348	0.00969037732834509042	0.01680765707488505027	0.02393850225167713185	0.03108336264064774755	0.00324269550508037325	0.01041696337985284296	0.01760663166561905393	0.02481216602805368054	0.03203402960487866290	0.00427268002509671911	0.01152856624666069394	0.01880212522069711064	0.02609377839236487934	0.03340392805045093743	0.00573295353986705773	0.01308120735329784916	0.02044901112033916245	0.02783665151453729903	0.03524437610076988603	0.00767238914737519363	0.01512084742931330689	0.02258985605040455756	0.03007946431431224380	0.03758966167539212752	0.01012037380179496841	0.01767145878425549625	0.02524270352480775336	0.03283382034020997562	0.04044444381512111569	0.01307412794002676568	0.02072234356854801560	0.02838847622806882340	0.03607182431657495480	0.04377159771720301152	0.01648691686024765652	0.02421681226026886918	0.03196022455348297203	0.03971600505781950660	0.04748291687489333050	0.02025963654969442981	0.02804475630005807314	0.03583678682397051375	0.04363416068852001694	0.05143523629985302108	0.02423830244887785527	0.03204158342271410883	0.03984324466705791944	0.04764139897976810130	0.05543411321112321987	0.02821941544140502041	0.03599530260177959622	0.04375974849992527981	0.05151071220754616382	0.05924614676286223586	0.03196400813742966310	0.03966226441326394487	0.04733890511325784436	0.05499195062534519561	0.06261946165879687440	0.03521954866947792711	0.04279038118987157907	0.05033019699920766889	0.05783731106913525696	0.06531012422106090897	0.03774713143253831789	0.04514692973193789077	0.05250822562303656485	0.05982984198413181361	0.06711072438977656549	0.03934994680722442824	0.04654671662413214741	0.05370037896894807689	0.06081042029067598923	0.06787647117029264226	0.03989830834196102960	0.04687585590826173275	0.05380918573990218870	0.06069851705669600554	0.06754421519296856032	0.03934678955687747196	0.04610689079937401840	0.05282530721461217959	0.05950296039947566419	0.06614090020548257831	0.03774029902158820442	0.04430244543128852045	0.05082873729188499411	0.05732067428776428708	0.06377985001303976315	0.03520794364186595855	0.04160671124714945779	0.04797797683022331346	0.05432362312531713469	0.06064558224333764626	0.03194582621957775316	0.03822635752950511948	0.04448919963575927086	0.05073638762793034309	0.05696995901462934321	0.02819194472482067954	0.03440436037240877751	0.04060919783469182209	0.04680841719156044340	0.05300393906827365828	0.02419763742033692484	0.03039133279448760114	0.03658678609511213654	0.04278569288062791872	0.04898967820951142087	0.02020029205079273753	0.02641900526901281976	0.03264720618889971314	0.03888619774040731538	0.04513719518031508466	0.01640132438234687585	0.02267962068376513404	0.02897302827266258168	0.03528240009673273787	0.04160849827117429220	0.01295199496058939151	0.01931347370728481629	0.02569343117628606870	0.03209227928563161135	0.03851034768912788729	0.00994788657771146269	0.01640506976487519206	0.02288199802125988524	0.02937870262347767898	0.03589514908250157888	0.00743124101750844301	0.01398682414187900286	0.02056169032911565920	0.02715558172771274219	0.03376819489547972917	0.00539918492545001109	0.01204816953728037122	0.01871473310993362765	0.02539843063341349565	0.03209879155936188532	0.00381532353241069319	0.01054751598627991649	0.01729484359071016802	0.02405676953739042508	0.03083274865507274736	0.00262223034603810052	0.00942466133797647249	0.01623948824715715807	0.02306615995048026513	0.02990412976560887028	0.00175285743987536404	0.00861181095002969107	0.01548046811614744420	0.02235831803413976714	0.02924486233230394882	0.00113961625822405295	0.00804210960307682194	0.01495188747102249299	0.02186851090186717401	0.02879155735557805984	0.00072062106752080563	0.00765531328347623187	0.01459526238358813925	0.02154011390440266826	0.02848953046808991731];
%xValues = 0:0.1:49.9;

maxSize = size(probabilities,2);

errors = zeros([1 maxSize]);
minError = inf;
bestThreshold = -1;

bestAlpha = -1;
bestMean1 = -1;
bestMean2 = -1;
bestVariance1 = -1;
bestVariance2 = -1;


set(gca, 'YTick', 0:0.01:max(probabilities));
set(gca, 'YTickLabel', 0:0.01:max(probabilities));
for schwellwert = 1:maxSize
    dataLeft = probabilities(1:schwellwert);
    dataRight = probabilities(schwellwert:maxSize);

    xValuesLeft = xValues(1:schwellwert);
    xValuesRight = xValues(schwellwert:maxSize);

    n = size(xValuesLeft,2);
    mean1 = mean(xValuesLeft);
    
    r1 = xValuesLeft-mean1;
    
    sum1 = sum(r1 .^2);
    variance1 = sqrt((1/(n))*sum1);

    n = size(xValuesRight,2);

    mean2 = mean(xValuesRight);
    
    r2 = xValuesRight-mean2;
    
    sum2 = sum(r2 .^2);
    variance2 = sqrt((1/(n))*sum2);

    weightLeft = sum(dataLeft);
    weightRight = sum(dataRight);
    totalWeight = weightLeft + weightRight;

    alpha = 0;
    if(weightLeft ~= 0)
        alpha = weightLeft/totalWeight;
    end
    
    approxPropabilities = alpha * normpdf(xValues, mean1, variance1) + (1-alpha)*normpdf(xValues,mean2, variance2);
    hold off;
    plot(xValues, approxPropabilities);
    ylim([0 max(probabilities)]);
    hold on;
    plot(xValues, probabilities);
    result = probabilities - approxPropabilities;
    plot(xValues, result);
    error = sum(abs(result));
    
    xValues(schwellwert)
    error
    
    errors(schwellwert) = error;
    if error < minError
        bestAlpha = alpha;
        minError = error;
        bestThreshold = xValues(schwellwert);
        bestMean1 = mean1;
        bestMean2 = mean2;
        bestVariance1 = variance1;
        bestVariance2 = variance2;
    end
end

bestAlpha
minError
bestThreshold


hold off;
approxPropabilities = bestAlpha * normpdf(xValues, bestMean1, bestVariance1) + (1-bestAlpha)*normpdf(xValues,bestMean2, bestVariance2);
plot(xValues, approxPropabilities);
ylim([0 max(probabilities)]);
hold on;
plot(xValues, probabilities);
result = probabilities - approxPropabilities;
plot(xValues, result);
